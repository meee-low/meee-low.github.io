import{s as q,n as E,r as F,c as C,o as G,e as L,f as O,t as z}from"../chunks/scheduler.Qsv3XV_C.js";import{S as B,i as H,s as P,e as k,f as S,c as w,a as D,d as _,k as p,g as y,h as v,w as U,r as J,t as V,b as $,j}from"../chunks/index.4hiSCMsU.js";import{e as N}from"../chunks/each.D8rep6LZ.js";import{g as K}from"../chunks/entry.CyGHBQmc.js";import{i as A}from"../chunks/images_store.DLIbdK8b.js";function M(i,a,t){const l=i.slice();return l[5]=a[t],l[7]=t,l}function R(i){let a,t=`Loading... Loaded ${i[1].length} out of ${i[0]} images.`,l;return{c(){a=k("div"),l=V(t)},l(r){a=w(r,"DIV",{});var s=D(a);l=$(s,t),s.forEach(_)},m(r,s){y(r,a,s),v(a,l)},p(r,s){s&3&&t!==(t=`Loading... Loaded ${r[1].length} out of ${r[0]} images.`)&&j(l,t)},d(r){r&&_(a)}}}function T(i){let a,t,l,r,s,h=i[5].file.name+"",g,f;return{c(){a=k("div"),t=k("img"),r=P(),s=k("span"),g=V(h),f=P(),this.h()},l(m){a=w(m,"DIV",{class:!0});var d=D(a);t=w(d,"IMG",{class:!0,src:!0,alt:!0}),r=S(d),s=w(d,"SPAN",{class:!0});var o=D(s);g=$(o,h),o.forEach(_),f=S(d),d.forEach(_),this.h()},h(){p(t,"class","mx-auto max-h-[85%] max-w-full border object-contain"),L(t.src,l=i[5].url)||p(t,"src",l),p(t,"alt",`Uploaded image ${i[7]}`),p(s,"class","block overflow-hidden text-ellipsis whitespace-nowrap text-center"),p(a,"class","max-h-[33vh]")},m(m,d){y(m,a,d),v(a,t),v(a,r),v(a,s),v(s,g),v(a,f)},p(m,d){d&2&&!L(t.src,l=m[5].url)&&p(t,"src",l),d&2&&h!==(h=m[5].file.name+"")&&j(g,h)},d(m){m&&_(a)}}}function Q(i){let a,t,l,r,s,h,g,f,m,d,o=i[2]&&R(i),b=N(i[1]),c=[];for(let e=0;e<b.length;e+=1)c[e]=T(M(i,b,e));return{c(){o&&o.c(),a=P(),t=k("form"),l=k("input"),r=P(),s=k("input"),g=P(),f=k("div");for(let e=0;e<c.length;e+=1)c[e].c();this.h()},l(e){o&&o.l(e),a=S(e),t=w(e,"FORM",{});var n=D(t);l=w(n,"INPUT",{class:!0,type:!0,accept:!0}),r=S(n),s=w(n,"INPUT",{class:!0,type:!0}),n.forEach(_),g=S(e),f=w(e,"DIV",{class:!0});var u=D(f);for(let I=0;I<c.length;I+=1)c[I].l(u);u.forEach(_),this.h()},h(){p(l,"class","mb-4"),p(l,"type","file"),p(l,"accept","image/*"),l.multiple=!0,p(s,"class",h=(i[2]?"cursor-wait":"cursor-pointer")+" block rounded-sm border border-black p-2"),p(s,"type","submit"),s.disabled=i[2],p(f,"class","grid grid-cols-2 gap-4 md:grid-cols-5 lg:grid-cols-8")},m(e,n){o&&o.m(e,n),y(e,a,n),y(e,t,n),v(t,l),v(t,r),v(t,s),y(e,g,n),y(e,f,n);for(let u=0;u<c.length;u+=1)c[u]&&c[u].m(f,null);m||(d=[U(l,"change",i[3]),U(t,"submit",i[4])],m=!0)},p(e,[n]){if(e[2]?o?o.p(e,n):(o=R(e),o.c(),o.m(a.parentNode,a)):o&&(o.d(1),o=null),n&4&&h!==(h=(e[2]?"cursor-wait":"cursor-pointer")+" block rounded-sm border border-black p-2")&&p(s,"class",h),n&4&&(s.disabled=e[2]),n&2){b=N(e[1]);let u;for(u=0;u<b.length;u+=1){const I=M(e,b,u);c[u]?c[u].p(I,n):(c[u]=T(I),c[u].c(),c[u].m(f,null))}for(;u<c.length;u+=1)c[u].d(1);c.length=b.length}},i:E,o:E,d(e){e&&(_(a),_(t),_(g),_(f)),o&&o.d(e),J(c,e),m=!1,F(d)}}}function W(i,a,t){let l,r;C(i,A,f=>t(1,r=f));let s=0;G(()=>{t(0,s=r.length)});async function h(f){const m=f.currentTarget;if(!m.files)return;const d=Array.from(m.files);t(0,s+=d.length);const o=d.map(b=>{new Promise(c=>{const e=new FileReader;e.onload=n=>{n.target&&n.target.result&&typeof n.target.result=="string"?(O(A,r=[...r,{url:n.target.result,file:b}],r),z().then(c)):c()},e.readAsDataURL(b)})});await Promise.all(o)}function g(f){f.preventDefault();const m=window.location.pathname;K(`${m}/rank`)}return i.$$.update=()=>{i.$$.dirty&3&&t(2,l=r.length!==s)},[s,r,l,h,g]}class te extends B{constructor(a){super(),H(this,a,W,Q,q,{})}}export{te as component};
