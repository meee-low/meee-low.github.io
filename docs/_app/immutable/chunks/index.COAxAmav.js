import{d as w}from"./index.C8jM4Ce1.js";import{g as h}from"./scheduler.D9M2Mvwn.js";function g(a,u,e,r){var t,f,l=!1,p=e.length>=2,y=(s,i,d)=>{if(t=i,p&&(f=s),!l){let n=u(s,i,d);if(u.length<2)i(n);else return n}l=!1},v=w(a,y,r),D=!Array.isArray(a);function A(s){var i=e(s,f);D?(l=!0,a.set(i)):i.forEach((d,n)=>{l=!0,a[n].set(d)}),l=!1}var o=!1;function b(s){var i,d,n,c;if(o){c=s(h(v)),t(c);return}var S=v.subscribe(V=>{o?i?d=!0:i=!0:n=V});c=s(n),o=!0,t(c),S(),o=!1,d&&(c=h(v)),i&&A(c)}return{subscribe:v.subscribe,set(s){b(()=>s)},update:b}}function O(a,u){if(Array.isArray(u)){let e=u.concat();return g(a,r=>{for(let t=0;t<e.length;++t)r=r[e[t]];return r},(r,t)=>{let f=t;for(let l=0;l<e.length-1;++l)f=f[e[l]];return f[e[e.length-1]]=r,t})}else return g(a,e=>e[u],(e,r)=>(r[u]=e,r))}export{O as p};
